<!Doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Babylon + OpenPose Test Test</title>
    <script src="https://cdn.babylonjs.com/babylon.max.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <canvas id="canvas"></canvas>
    <script>
        const setUp = () => {
            const canvas = document.getElementById('canvas');
            const engine = new BABYLON.Engine(canvas, true);
            const createScene = function () {
                const scene = new BABYLON.Scene(engine);
                scene.clearColor = new BABYLON.Color3(0.65, 0.81, 0.67);

                //camera
                const camera = new BABYLON.FreeCamera('camera1', new BABYLON.Vector3(0, 3, -10), scene);
                camera.setTarget(BABYLON.Vector3.Zero());
                camera.attachControl(canvas, true);

                //Lichtinval
                var light = new BABYLON.PointLight("light", new BABYLON.Vector3(0, 0, -3), scene);
                light.intensity = .3;

                //Player
                const player = BABYLON.Mesh.CreateBox("Player", 1.6, 0, scene);
                player.position = new BABYLON.Vector3(0, -2, -2);
                
                const material1 = new BABYLON.StandardMaterial("material1", scene);
                material1.emissiveColor = BABYLON.Color3.Red();
                player.material = material1;

                //Obstakels
                const box1 = BABYLON.Mesh.CreateBox("Box1", 1.5, 0, scene);
                const box2 = BABYLON.Mesh.CreateBox("Box2", 1.5, 0, scene);
                const box3 = BABYLON.Mesh.CreateBox("Box3", 1, 0, scene);
                const box4 = BABYLON.Mesh.CreateBox("Box4", .5, 0, scene);
                const box5 = BABYLON.Mesh.CreateBox("Box5", .5, 0, scene);

                box1.position = new BABYLON.Vector3(-3,  -2, 3);
                box2.position = new BABYLON.Vector3(3,  -2, 1);
                box3.position = new BABYLON.Vector3(0,  -2, 6);
                box4.position = new BABYLON.Vector3(-3,  -2, 12);
                box5.position = new BABYLON.Vector3(3,  -2, 15);

                //Ground
                const ground = BABYLON.MeshBuilder.CreateGround("gd", {width: 12, height: 30, subdivsions: 4}, scene);
                ground.position = new BABYLON.Vector3(0,-3,10);

                const groundMaterial = new BABYLON.StandardMaterial("groundMaterial", scene);
                groundMaterial.emissiveColor = new BABYLON.Color3(0.85, 0.77, 0.60);
                ground.material = groundMaterial;

                //keyboard input "w" en "x"
                scene.onKeyboardObservable.add((kbInfo) => {
                    switch (kbInfo.type) {
                        case BABYLON.KeyboardEventTypes.KEYDOWN:
                            switch (kbInfo.event.key) {
                                case "w":
                                case "W" : 
                                    player.position.x -= 3;
                                break;
                                case "x":
                                case "X":
                                    player.position.x += 3;
                                break;
                            }
                        break;
                    }
                })

                return scene;
            }
    
            const scene = createScene();
            engine.runRenderLoop(function () {
                scene.render();
            });
        }
        window.addEventListener('DOMContentLoaded', setUp());
    </script>

</body>
</html>

